<div class="container-contact100">
  <div class="container" style="text-align: center;">
    <form novalidate #myForm>
      <table style="margin-left: 15%">
        <div class="heading">
          <a class="homeButton" routerLink="/">
            <img src="home.png" width="55px" alt="Home Button" />
          </a>
          <h1 class="headingMetadata">Meta Data Report</h1>
        </div>
        <div class="form-group" style=" margin-top: 4%;">
          <tr class="table-row">
            <td class="table-data">
              <label class=".control-label" for="group" style="text-align: left;">
                <span>
                  <b>{{ groupSub }}:</b>
                </span>
              </label>
            </td>
            <td class="table-data">
              <select class="form-control inputstl" required [(ngModel)]="selectedGroup" [ngModelOptions]="{standalone: true}" (change)="filterForeCasts($event.target.value)">
                <option *ngFor="let group of groups" [value]="group.name">
                  {{group.name}}
                </option>
              </select>
            </td>
            <td>
              &nbsp;
            </td>
          </tr>
        </div>
        <br>
        <div class="form-group">
          <tr class="table-row">
            <td class="table-data">
              <label class="center-block" for="attribute">
                <span>
                  <b>{{attribute}}:</b>
                </span>
              </label>
            </td>
            <td class="table-data">
              <input id="allAttributes" type="radio" name="attribute" value="All" [disabled]="btnDisable" [(ngModel)]="selectedAttribute"
                (change)="filterForeCastsNew($event.target.value)" checked><label for="allAttributes">All Attributes</label>
              <br>
              <input id="limitedAttributes" type="radio" name="attribute" value="limited" [disabled]="btnDisable" (change)="filterForeCastsNew($event.target.value)"><label
                for="limitedAttributes">Limited Attributes</label> <br>
            </td>
            <td class="table-data">
              <select class="multiselect-ui form-control inputstl" *ngIf="butDisabled" id="dates-field2" multiple="multiple" [(ngModel)]="selectedAttribute"
                [ngModelOptions]="{standalone: true}" (click)="filterForeCastsNew2($event.target.value)" required>
                <option *ngFor="let attribute of attributes" [value]="attribute.name">
                  {{attribute.name}}
                </option>
              </select>
            </td>
          </tr>
          <br>
          <tr>
            <td>
              &nbsp;
            </td>
            <td>
              <button type="submit" [disabled]="btnDisable2" (click)=getReport(selectedGroup,selectedAttribute) style="padding: 5% 12%; background-color: rgb(39, 102, 150);"
                class="btn btn-md btn-block btn-info">
                Get Report
              </button>
            </td>
            <td>
              &nbsp;
            </td>
          </tr>
        </div>
      </table>
    </form>
  </div>
</div>
<div class="loading" id="loader">Loading&#8230;</div>
<div align="center">
  <button type="button" *ngIf="excelbutton" class="btn btn-md btn-block btn-info" style="width: 11%;background-color: rgb(39, 102, 150); display: inline-block;margin: 5px;"
    id="btnExport" (click)=exportExcel(selectedGroup)>Download As Excel
  </button>
  <button type="button" *ngIf="excelbutton" class="btn btn-md btn-block btn-info" style="width: 11%;background-color: rgb(39, 102, 150); display: inline-block;margin: 5px;"
    id="print" (click)=printFunc()>Print
  </button>
</div>
<br>
<div align="center">
  <table id="reporttable" *ngIf="theading" style="border: 2px solid black;background-color: #D6EAF8;border-collapse: collapse;"
    align="center">
    <tr>
      <th style="width: 50px; border: 2px solid black; text-align: center;" *ngIf="expandDisable">
      </th>
      <th id="thhead" *ngFor="let field of allFields" style="border: 2px solid black; text-align: center;width: 90px;"> {{field}}</th>
    </tr>
    <tr *ngFor="let adata of allPush">
      <td style="border: 1px solid black;text-align: center;" *ngIf="expandDisable">
        <button *ngIf="expanded" (click)="Expand(true)" style="width: 50%;">-</button>
        <button *ngIf="!expanded" (click)="Expand(false)" style="width: 50%;">+</button>
      </td>
      <td id="tdh" *ngFor="let col of adata" style="border: 1px solid black;text-align: center;">{{col}}</td>
    </tr>
  </table>
</div>